import{N as Te,O as Ae,r as h,w as de,g as a,l as he,Q as ye,s as Ie,e as A,R as Fe,S as We,T as u,d as se,U as xe,_ as ue,V as q,W as Ye,f as s,F as De,c as ne,j as re,X as Le,Y as Xe,Z as Se,P as Ze,b as Ke,$ as He,a0 as Be,a1 as qe,a2 as Qe,C as Je,a3 as er,a4 as rr,a as Oe,h as Me,a5 as nr,a6 as ar}from"./index-f434bbd9.js";import{g as tr,u as _e,b as ir,d as or,D as lr,e as Re}from"./index-0be9cb0e.js";var ur="[object Number]";function sr(o){return typeof o=="number"||Te(o)&&Ae(o)==ur}function vr(o){var e=h(null),l=de(a({},o)),r=h([]),i=function(g){e.value===null&&(r.value=[],e.value=ye(function(){var m;r.value.forEach(function(N){m=a(a({},m),N)}),Ie(l,m),e.value=null})),r.value.push(g)};return he(function(){e.value&&ye.cancel(e.value)}),[l,i]}function ke(o,e,l,r){var i=e+l,n=(l-r)/2;if(l>r){if(e>0)return A({},o,n);if(e<0&&i<r)return A({},o,-n)}else if(e<0||i>r)return A({},o,e<0?n:-n);return{}}function cr(o,e,l,r){var i=tr(),n=i.width,g=i.height,m=null;return o<=n&&e<=g?m={x:0,y:0}:(o>n||e>g)&&(m=a(a({},ke("x",l,o,n)),ke("y",r,e,g))),m}var Ne=Symbol("previewGroupContext"),be={provide:function(e){Fe(Ne,e)},inject:function(){return We(Ne,{isPreviewGroup:h(!1),previewUrls:u(function(){return new Map}),setPreviewUrls:function(){},current:h(null),setCurrent:function(){},setShowPreview:function(){},setMousePosition:function(){},registerImage:null,rootClassName:""})}},fr=se({compatConfig:{MODE:3},name:"PreviewGroup",inheritAttrs:!1,props:{previewPrefixCls:String,preview:{type:[Boolean,Object],default:!0},icons:{type:Object,default:function(){return{}}}},setup:function(e,l){var r=l.slots,i=u(function(){var d={visible:void 0,onVisibleChange:function(){},getContainer:void 0,current:0};return xe(e.preview)==="object"?Ue(e.preview,d):d}),n=de(new Map),g=h(),m=u(function(){return i.value.visible}),N=u(function(){return i.value.getContainer}),$=function(v,k){var P,_;(P=(_=i.value).onVisibleChange)===null||P===void 0||P.call(_,v,k)},x=_e(!!m.value,{value:m,onChange:$}),C=ue(x,2),T=C[0],w=C[1],y=h(null),Q=u(function(){return m.value!==void 0}),W=u(function(){return Array.from(n.keys())}),b=u(function(){return W.value[i.value.current]}),L=u(function(){return new Map(Array.from(n).filter(function(d){var v=ue(d,2),k=v[1].canPreview;return!!k}).map(function(d){var v=ue(d,2),k=v[0],P=v[1].url;return[k,P]}))}),G=function(v,k){var P=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;n.set(v,{url:k,canPreview:P})},O=function(v){g.value=v},S=function(v){y.value=v},M=function(v,k){var P=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,_=function(){n.delete(v)};return n.set(v,{url:k,canPreview:P}),_},j=function(v){v==null||v.stopPropagation(),w(!1),S(null)};return q(b,function(d){O(d)},{immediate:!0,flush:"post"}),Ye(function(){T.value&&Q.value&&O(b.value)},{flush:"post"}),be.provide({isPreviewGroup:h(!0),previewUrls:L,setPreviewUrls:G,current:g,setCurrent:O,setShowPreview:w,setMousePosition:S,registerImage:M}),function(){var d=Ie({},(ir(i.value),i.value));return s(De,null,[r.default&&r.default(),s(je,a(a({},d),{},{"ria-hidden":!T.value,visible:T.value,prefixCls:e.previewPrefixCls,onClose:j,mousePosition:y.value,src:L.value.get(g.value),icons:e.icons,getContainer:N.value}),null)])}}});const Ge=fr;var H={x:0,y:0},dr=a(a({},or()),{},{src:String,alt:String,rootClassName:String,icons:{type:Object,default:function(){return{}}}}),mr=se({compatConfig:{MODE:3},name:"Preview",inheritAttrs:!1,props:dr,emits:["close","afterClose"],setup:function(e,l){var r=l.emit,i=l.attrs,n=de(e.icons),g=n.rotateLeft,m=n.rotateRight,N=n.zoomIn,$=n.zoomOut,x=n.close,C=n.left,T=n.right,w=h(1),y=h(0),Q=vr(H),W=ue(Q,2),b=W[0],L=W[1],G=function(){return r("close")},O=h(),S=de({originX:0,originY:0,deltaX:0,deltaY:0}),M=h(!1),j=be.inject(),d=j.previewUrls,v=j.current,k=j.isPreviewGroup,P=j.setCurrent,_=u(function(){return d.value.size}),I=u(function(){return Array.from(d.value.keys())}),D=u(function(){return I.value.indexOf(v.value)}),me=u(function(){return k.value?d.value.get(v.value):e.src}),ae=u(function(){return k.value&&_.value>1}),te=h({wheelDirection:0}),Y=function(){w.value=1,y.value=0,L(H),r("afterClose")},X=function(){w.value++,L(H)},ie=function(){w.value>1&&w.value--,L(H)},f=function(){y.value+=90},p=function(){y.value-=90},V=function(t){t.preventDefault(),t.stopPropagation(),D.value>0&&P(I.value[D.value-1])},U=function(t){t.preventDefault(),t.stopPropagation(),D.value<_.value-1&&P(I.value[D.value+1])},z=ne(A({},"".concat(e.prefixCls,"-moving"),M.value)),we="".concat(e.prefixCls,"-operations-operation"),ve="".concat(e.prefixCls,"-operations-icon"),ge=[{icon:x,onClick:G,type:"close"},{icon:N,onClick:X,type:"zoomIn"},{icon:$,onClick:ie,type:"zoomOut",disabled:u(function(){return w.value===1})},{icon:m,onClick:f,type:"rotateRight"},{icon:g,onClick:p,type:"rotateLeft"}],oe=function(){if(e.visible&&M.value){var t=O.value.offsetWidth*w.value,R=O.value.offsetHeight*w.value,Z=Re(O.value),E=Z.left,K=Z.top,F=y.value%180!==0;M.value=!1;var J=cr(F?R:t,F?t:R,E,K);J&&L(a({},J))}},pe=function(t){t.button===0&&(t.preventDefault(),t.stopPropagation(),S.deltaX=t.pageX-b.x,S.deltaY=t.pageY-b.y,S.originX=b.x,S.originY=b.y,M.value=!0)},ce=function(t){e.visible&&M.value&&L({x:t.pageX-S.deltaX,y:t.pageY-S.deltaY})},fe=function(t){if(e.visible){t.preventDefault();var R=t.deltaY;te.value={wheelDirection:R}}},Ce=function(t){!e.visible||!ae.value||(t.preventDefault(),t.keyCode===Se.LEFT?D.value>0&&P(I.value[D.value-1]):t.keyCode===Se.RIGHT&&D.value<_.value-1&&P(I.value[D.value+1]))},Pe=function(){e.visible&&(w.value!==1&&(w.value=1),(b.x!==H.x||b.y!==H.y)&&L(H))},le=function(){};return he(function(){q([function(){return e.visible},M],function(){le();var c,t,R=re(window,"mouseup",oe,!1),Z=re(window,"mousemove",ce,!1),E=re(window,"wheel",fe,{passive:!1}),K=re(window,"keydown",Ce,!1);try{window.top!==window.self&&(c=re(window.top,"mouseup",oe,!1),t=re(window.top,"mousemove",ce,!1))}catch{}le=function(){R.remove(),Z.remove(),E.remove(),K.remove(),c&&c.remove(),t&&t.remove()}},{flush:"post",immediate:!0}),q([te],function(){var c=te.value.wheelDirection;c>0?ie():c<0&&X()})}),Le(function(){le()}),function(){var c=e.visible,t=e.prefixCls,R=e.rootClassName;return s(lr,a(a({},i),{},{transitionName:"zoom",maskTransitionName:"fade",closable:!1,keyboard:!0,prefixCls:t,onClose:G,afterClose:Y,visible:c,wrapClassName:z,rootClassName:R,getContainer:e.getContainer}),{default:function(){return[s("ul",{class:"".concat(e.prefixCls,"-operations")},[ge.map(function(E){var K=E.icon,F=E.onClick,J=E.type,ee=E.disabled;return s("li",{class:ne(we,A({},"".concat(e.prefixCls,"-operations-operation-disabled"),ee&&(ee==null?void 0:ee.value))),onClick:F,key:J},[Xe(K,{class:ve})])})]),s("div",{class:"".concat(e.prefixCls,"-img-wrapper"),style:{transform:"translate3d(".concat(b.x,"px, ").concat(b.y,"px, 0)")}},[s("img",{onMousedown:pe,onDblclick:Pe,ref:O,class:"".concat(e.prefixCls,"-img"),src:me.value,alt:e.alt,style:{transform:"scale3d(".concat(w.value,", ").concat(w.value,", 1) rotate(").concat(y.value,"deg)")}},null)]),ae.value&&s("div",{class:ne("".concat(e.prefixCls,"-switch-left"),A({},"".concat(e.prefixCls,"-switch-left-disabled"),D.value<=0)),onClick:V},[C]),ae.value&&s("div",{class:ne("".concat(e.prefixCls,"-switch-right"),A({},"".concat(e.prefixCls,"-switch-right-disabled"),D.value>=_.value-1)),onClick:U},[T])]}})}}});const je=mr;var wr=["icons","maskClassName"],Ve=function(){return{src:String,wrapperClassName:String,wrapperStyle:{type:Object,default:void 0},rootClassName:String,prefixCls:String,previewPrefixCls:String,previewMask:{type:[Boolean,Function],default:void 0},placeholder:Ze.any,fallback:String,preview:{type:[Boolean,Object],default:!0},onClick:{type:Function},onError:{type:Function}}},Ue=function(e,l){var r=a({},e);return Object.keys(l).forEach(function(i){e[i]===void 0&&(r[i]=l[i])}),r},gr=0,ze=se({compatConfig:{MODE:3},name:"Image",inheritAttrs:!1,props:Ve(),emits:["click","error"],setup:function(e,l){var r=l.attrs,i=l.slots,n=l.emit,g=u(function(){return e.prefixCls}),m=u(function(){return"".concat(g.value,"-preview")}),N=u(function(){var f={visible:void 0,onVisibleChange:function(){},getContainer:void 0};return xe(e.preview)==="object"?Ue(e.preview,f):f}),$=u(function(){var f;return(f=N.value.src)!==null&&f!==void 0?f:e.src}),x=u(function(){return e.placeholder&&e.placeholder!==!0||i.placeholder}),C=u(function(){return N.value.visible}),T=u(function(){return N.value.getContainer}),w=u(function(){return C.value!==void 0}),y=function(p,V){var U,z;(U=(z=N.value).onVisibleChange)===null||U===void 0||U.call(z,p,V)},Q=_e(!!C.value,{value:C,onChange:y}),W=ue(Q,2),b=W[0],L=W[1];q(b,function(f,p){y(f,p)});var G=h(x.value?"loading":"normal");q(function(){return e.src},function(){G.value=x.value?"loading":"normal"});var O=h(null),S=u(function(){return G.value==="error"}),M=be.inject(),j=M.isPreviewGroup,d=M.setCurrent,v=M.setShowPreview,k=M.setMousePosition,P=M.registerImage,_=h(gr++),I=u(function(){return e.preview&&!S.value}),D=function(){G.value="normal"},me=function(p){G.value="error",n("error",p)},ae=function(p){if(!w.value){var V=Re(p.target),U=V.left,z=V.top;j.value?(d(_.value),k({x:U,y:z})):O.value={x:U,y:z}}j.value?v(!0):L(!0),n("click",p)},te=function(){L(!1),w.value||(O.value=null)},Y=h(null);q(function(){return Y},function(){G.value==="loading"&&Y.value.complete&&(Y.value.naturalWidth||Y.value.naturalHeight)&&D()});var X=function(){};he(function(){q([$,I],function(){if(X(),!j.value)return function(){};X=P(_.value,$.value,I.value),I.value||X()},{flush:"post",immediate:!0})}),Le(function(){X()});var ie=function(p){return sr(p)?p+"px":p};return function(){var f=e.prefixCls,p=e.wrapperClassName,V=e.fallback,U=e.src,z=e.placeholder,we=e.wrapperStyle,ve=e.rootClassName,ge=r.width,oe=r.height,pe=r.crossorigin,ce=r.decoding,fe=r.alt,Ce=r.sizes,Pe=r.srcset,le=r.usemap,c=r.class,t=r.style,R=N.value,Z=R.icons,E=R.maskClassName,K=Ke(R,wr),F=ne(f,p,ve,A({},"".concat(f,"-error"),S.value)),J=S.value&&V?V:$.value,ee={crossorigin:pe,decoding:ce,alt:fe,sizes:Ce,srcset:Pe,usemap:le,class:ne("".concat(f,"-img"),A({},"".concat(f,"-img-placeholder"),z===!0),c),style:a({height:oe},t)};return s(De,null,[s("div",{class:F,onClick:I.value?ae:function($e){n("click",$e)},style:a({width:ie(ge),height:ie(oe)},we)},[s("img",a(a(a({},ee),S.value&&V?{src:V}:{onLoad:D,onError:me,src:U}),{},{ref:Y}),null),G.value==="loading"&&s("div",{"aria-hidden":"true",class:"".concat(f,"-placeholder")},[z||i.placeholder&&i.placeholder()]),i.previewMask&&I.value&&s("div",{class:["".concat(f,"-mask"),E]},[i.previewMask()])]),!j.value&&I.value&&s(je,a(a({},K),{},{"aria-hidden":!b.value,visible:b.value,prefixCls:m.value,onClose:te,mousePosition:O.value,src:J,alt:fe,getContainer:T.value,icons:Z,rootClassName:ve}),null)])}}});ze.PreviewGroup=Ge;const pr=ze;var Ee={rotateLeft:s(He,null,null),rotateRight:s(Be,null,null),zoomIn:s(qe,null,null),zoomOut:s(Qe,null,null),close:s(Je,null,null),left:s(er,null,null),right:s(rr,null,null)},Cr=se({compatConfig:{MODE:3},name:"AImagePreviewGroup",inheritAttrs:!1,props:{previewPrefixCls:String},setup:function(e,l){var r=l.attrs,i=l.slots,n=Oe("image",e),g=n.getPrefixCls,m=u(function(){return g("image-preview",e.previewPrefixCls)});return function(){return s(Ge,a(a({},a(a({},r),e)),{},{icons:Ee,previewPrefixCls:m.value}),i)}}});const Pr=Cr;var B=se({name:"AImage",inheritAttrs:!1,props:Ve(),setup:function(e,l){var r=l.slots,i=l.attrs,n=Oe("image",e),g=n.prefixCls,m=n.rootPrefixCls,N=n.configProvider,$=u(function(){var x=e.preview;if(x===!1)return x;var C=xe(x)==="object"?x:{};return a(a({icons:Ee},C),{},{transitionName:Me(m.value,"zoom",C.transitionName),maskTransitionName:Me(m.value,"fade",C.maskTransitionName)})});return function(){var x,C=((x=N.locale)===null||x===void 0?void 0:x.Image)||nr.Image,T=function(){return s("div",{class:"".concat(g.value,"-mask-info")},[s(ar,null,null),C==null?void 0:C.preview])},w=e.previewMask,y=w===void 0?r.previewMask||T:w;return s(pr,a(a({},a(a(a({},i),e),{},{prefixCls:g.value})),{},{preview:$.value}),a(a({},r),{},{previewMask:typeof y=="function"?y:null}))}}});B.PreviewGroup=Pr;B.install=function(o){return o.component(B.name,B),o.component(B.PreviewGroup.name,B.PreviewGroup),o};const br=B;export{br as _};
